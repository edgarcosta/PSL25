AttachSpec("spec");
SetVerbose("Shimura",true);
SetDebugOnError(true);
sigma := 
[Sym(17) |
(1, 13, 14, 5, 17, 8, 3, 16, 15, 6, 10, 4, 9, 7, 11),
(2, 5)(4, 14)(6, 16)(7, 12)(8, 11)(9, 17),
(1, 8, 9, 14, 13)(2, 5, 4, 10, 16, 3, 11, 12, 7, 17)(6, 15)
];
Gamma := TriangleSubgroup(sigma);
X, phi := BelyiMap(Gamma : prec := 80, precNewton := 200);

s = 15, t = 3
// phi0 in L(too), phioo in L((s+t)oo)

// numerical coefficients
CC<i> := ComplexField(30);

num_coeffs := [ 0.0068359375000000000000000000000000000000002951810735 - 6.8862347120569112830111665255789174665216247061872E-44*i, 0.062499999999999999999999999999999999999993158696683 + 2.6172280932025647824353103586029146521582304024077E-43*i, 1.0000000000000000000000000000000000000000000000000 ];
den_coeffs := 
[ -1.8263168755083825089968740940093994140630497978096E-14 + 7.6656608415064861886927750855842939019306879676610E-55*i, 5.3752557960251579061150550842285156250007682269861E-12 - 5.2003673931380606752640451271754595676045349672409E-53*i, -2.9558577807620167732238769531250000000001054902845E-12 - 4.4853212999346182379578549062772075806194961591148E-53*i, -6.0481397667899727821350097656250000000007237639073E-10 + 6.5540346429926228506571323690907005879722657857526E-51*i, 9.1677065938711166381835937500000000000009627582179E-10 - 7.0270100298496012913113321300166920352783328634948E-51*i, 3.0559021979570388793945312500000000000003515711178E-8 - 4.2470688289617896094012486208262552157498788782237E-49*i, -1.1269003152847290039062500000000000000001155115827E-7 + 1.1075383910963158837219357759121098635812613682544E-48*i, -4.8987567424774169921875000000000000000007843409178E-7 + 1.4079932787117987483590465194367617000724938506438E-47*i, 6.8545341491699218750000000000000000000006418351337E-6 - 6.7167508535235214481807723320680723663655681231611E-47*i, -1.3470649719238281249999999999999999999999406856580E-5 - 2.6207304063458432934646856830420455187732543867750E-46*i, -0.00020980834960937500000000000000000000000001848405712 + 1.9860702924867934966710365340802376946232251584654E-45*i, 0.00065612792968749999999999999999999999999999671825109 + 4.7167957608415729316116853311619803081450015591613E-45*i, 0.0031738281250000000000000000000000000000002798864015 - 2.3497005676655498774282903937788317695286566710539E-44*i, -0.014648437499999999999999999999999999999999818855239 - 6.7526270671359860687610376600280547550486885035987E-44*i, -0.046875000000000000000000000000000000000002213125049 + 4.8003946636638017766215550613865964806366064048197E-44*i, 0.23437499999999999999999999999999999999999650861644 + 1.7871573145918114534328072621164830192720050783927E-43*i, 1.0000000000000000000000000000000000000000000000000 + 4.8473762198802259745979166872981420325907244281129E-51*i, 1.0000000000000000000000000000000000000000000000000 ];
lc := 
1.3797371475784866898148148148148148148149682641290E-10 - 8.8089629503016511033040987181832303997763616667336E-52*i;
curve_coeffs :=
[ -4.5211226851851851851851851851851851851853192114616E-5 + 6.5261922095883711697493775830627402780786216620993E-47*i, -7.0642541956018518518518518518518518518521658119506E-7 + 1.8023364158055517356649599181149724393609361534173E-48*i ];
debug> p Gamma`TriangleNumericalCurveInvariants  
270.00000000000000000000000000000000000000001057669 + 1.7592274783184977668555970293037773913935246081953E-40*i

// exact coefficients

lc_QQ := 1/7247757312;
num_coeffs_QQ := [ 7/1024, 1/16, 1 ];
//den_coeffs_QQ := [ -2/109510021334237, 1513/281474976710656, -13/4398046511104, -665/1099511627776, 63/68719476736, 525/17179869184, -121/1073741824, -263/536870912, 115/16777216, -113/8388608, -55/262144, 43/65536, 13/4096, -15/1024, -3/64, 15/64, 1, 1 ];
den_coeffs_QQ := [ -329/18014398509481984, 1513/281474976710656, -13/4398046511104, -665/1099511627776, 63/68719476736, 525/17179869184, -121/1073741824, -263/536870912, 115/16777216, -113/8388608, -55/262144, 43/65536, 13/4096, -15/1024, -3/64, 15/64, 1, 1 ];
curve_coeffs_QQ := [ -5/110592, -5/7077888 ];

c4, c6 := Explode(curve_coeffs_QQ);
X := EllipticCurve([-27*c4, -54*c6]);
KX<x,y> := FunctionField(X);
basis := [1, x, y, x^2, x*y, x^3, x^2*y, x^4, x^3*y, x^5, x^4*y, x^6, x^5*y, x^7, x^6*y, x^8, x^7*y, x^9];
phi0 := &+[num_coeffs_QQ[i]*basis[i] : i in [1..#num_coeffs_QQ]];
phioo := &+[den_coeffs_QQ[i]*basis[i] : i in [1..#den_coeffs_QQ]];
phi := -lc_QQ*phi0/phioo;
