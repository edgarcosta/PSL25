ChangeDirectory("~/github/Belyi/Code");
AttachSpec("spec");
SetVerbose("Shimura",true);
SetDebugOnError(true);
G := SmallGroup(120,5);
triples := PassportRepresentatives(G);
/*
genera := [];
for i := 1 to #triples do
  sigma := triples[i][2][1];
  Gamma := TriangleSubgroup(sigma : Simplify := 0);
  Append(~genera, Genus(Gamma));
end for;
*/
/*
  sigma := [ PermutationGroup<24 |  
    \[ 2, 4, 6, 8, 3, 9, 12, 1, 5, 14, 15, 13, 17, 11, 10, 20, 7, 22, 23, 21, 24, 19, 18, 16 ],
    \[ 3, 5, 7, 9, 10, 11, 1, 6, 13, 2, 8, 16, 4, 18, 19, 20, 21, 22, 23, 12, 24, 14, 15, 17 ]:
     Order := 120 > |
     [ 3, 5, 7, 9, 10, 11, 1, 6, 13, 2, 8, 16, 4, 18, 19, 20, 21, 22, 23, 12, 24, 14, 15, 17 ],
     [ 7, 10, 19, 13, 16, 21, 12, 11, 18, 14, 15, 6, 17, 3, 9, 4, 5, 8, 2, 20, 1, 22, 23, 24 ],
     [ 1, 2, 21, 4, 19, 18, 14, 8, 16, 17, 12, 20, 15, 22, 23, 7, 24, 10, 11, 5, 13, 9, 3, 6 ]
     ];
*/
//sigma := S3Action(Sym(3)!(3,2,1), sigma);
sigma := [ PermutationGroup<24 |  
\[ 2, 4, 6, 8, 3, 9, 12, 1, 5, 14, 15, 13, 17, 11, 10, 20, 7, 22, 23, 21, 24, 19, 18, 16 ],
\[ 3, 5, 7, 9, 10, 11, 1, 6, 13, 2, 8, 16, 4, 18, 19, 20, 21, 22, 23, 12, 24, 14, 15, 17 ]:
 Order := 120 > |
[ 21, 19, 14, 16, 17, 12, 1, 18, 15, 2, 8, 7, 4, 10, 11, 5, 13, 9, 3, 20, 6, 22, 23, 24 ],
[ 7, 10, 1, 13, 2, 8, 3, 11, 4, 5, 6, 20, 9, 22, 23, 12, 24, 14, 15, 16, 17, 18, 19, 21 ],
[ 1, 2, 23, 4, 20, 24, 16, 8, 22, 18, 19, 11, 21, 7, 13, 9, 10, 6, 5, 12, 3, 14, 15, 17 ]
];
Gamma := TriangleSubgroup(sigma);
//X, phi := BelyiMap(Gamma : prec := 80);

/*
  X := EllipticCurve([-1/1875, 322/421875]);
  KX<x,y> := FunctionField(X);
  lc := -864/3125;
  phi_num := (-34171875000*x^7 + 5011875000*x^6 + 309825000*x^5 - 83025000*x^4 + 2295000*x^3 + 297000*x^2 - 21000*x + 392)/533935546875*y + (-1802032470703125*x^10 + 48054199218750*x^9 + 31715771484375*x^8 - 1127671875000*x^7 - 93972656250*x^6 + 519412500*x^5 - 818606250*x^4 + 104085000*x^3 + 2055375*x^2 - 492450*x + 12691)/1802032470703125;
  phi_den := (422351360321044921875*x^11 - 39419460296630859375*x^10 + 31160144805908203125*x^9 - 5511215972900390625*x^8 + 754050476074218750*x^7 - 269309614746093750*x^6 + 4672733378906250*x^5 - 6068316550781250*x^4 - 58719057890625*x^3 - 64504585096875*x^2 - 645798586575*x - 261566072333)/422351360321044921875*y + (158381760120391845703125*x^12 + 10136432647705078125000*x^11 + 14224793815612792968750*x^10 + 420474243164062500000*x^9 + 463617903900146484375*x^8 - 5295572753906250000*x^7 + 6156488293945312500*x^6 - 502518608437500000*x^5 + 13192233169921875*x^4 - 8425671046875000*x^3 - 366048040781250*x^2 - 44718905404800*x - 2138687297311)/158381760120391845703125;
  phi := lc*phi_num/phi_den;
*/

// now with minimal model
X := EllipticCurve([3, 1, 1, 0, 0]);
KX<x,y> := FunctionField(X);
phi := (27*x^10 + 81*x^9 - 189*x^7 - 189*x^6 - 54*x^5)/(x^14 - 2*x^13 - 26*x^12 - 103*x^11 - 244*x^10 - 409*x^9 - 507*x^8 - 471*x^7 - 318*x^6 - 139*x^5 - 19*x^4 + 23*x^3 + 19*x^2 + 7*x + 1)*y + (-54*x^11 - 216*x^10 - 432*x^9 - 567*x^8 - 459*x^7 - 189*x^6 - 27*x^5)/(x^14 - 2*x^13 - 26*x^12 - 103*x^11 - 244*x^10 - 409*x^9 - 507*x^8 - 471*x^7 - 318*x^6 - 139*x^5 - 19*x^4 + 23*x^3 + 19*x^2 + 7*x + 1);

// plane model, x is Belyi map
// seems to have Galois group 24T1353 = GL(2,5) :(
// there looks to be a constant QQ(zeta_5) extension
F := x^3*y^24 + 33*x^3*y^23 + 159*x^3*y^22 + 332*x^3*y^21 + 501*x^3*y^20 + 951*x^3*y^19 + 1648*x^3*y^18 + 1989*x^3*y^17 + 2367*x^3*y^16 + 3296*x^3*y^15 + 3585*x^3*y^14 + 3135*x^3*y^13 + 3310*x^3*y^12 + 3315*x^3*y^11 + 2325*x^3*y^10 + 1676*x^3*y^9 + 1503*x^3*y^8 + 909*x^3*y^7 + 352*x^3*y^6 + 231*x^3*y^5 + 141*x^3*y^4 + 8*x^3*y^3 - 21*x^3*y^2 - 3*x^3*y + x^3 + 270*x^2*y^22 + 2565*x^2*y^21 + 7830*x^2*y^20 - 2727*x^2*y^19 - 79056*x^2*y^18 - 238518*x^2*y^17 - 368334*x^2*y^16 - 275292*x^2*y^15 + 71658*x^2*y^14 + 413019*x^2*y^13 + 470907*x^2*y^12 + 274401*x^2*y^11 + 55593*x^2*y^10 - 44145*x^2*y^9 - 42660*x^2*y^8 - 14040*x^2*y^7 - 135*x^2*y^6 + 945*x^2*y^5 + 135*x^2*y^4 + 3645*x*y^20 + 56862*x*y^19 + 309096*x*y^18 + 919998*x*y^17 + 1695654*x*y^16 + 2006937*x*y^15 + 1462374*x*y^14 + 523422*x*y^13 - 59049*x*y^12 - 126117*x*y^11 - 2916*x*y^10 + 57591*x*y^9 + 37908*x*y^8 + 8019*x*y^7 - 1458*x*y^6 - 729*x*y^5 - 19683*y^19 - 157464*y^18 - 570807*y^17 - 1220346*y^16 - 1692738*y^15 - 1594323*y^14 - 1043199*y^13 - 472392*y^12 - 137781*y^11 - 19683*y^10;
