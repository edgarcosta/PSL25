coeffs := [27/80, 1/4, 209/6400, 5/16, 19/40, -16119/2560000, 571/38400, 103/6400, 87/400, 7/16, 1/2, 98809/384000, 1241/1280, 1587/800, 121/40, 11/4, -14641/8192000000];
b1,c1,d01,d11,d21,e01,e11,e21,e31,e41,e51,f01,f11,f21,f31,f41,lc1 := Explode(coeffs);

phi0 := -14641/8192000000*x^2 - 395307/655360000000;
phioo := x^17 + 15/4*x^16 + 69/10*x^15 + 359/40*x^14 + 2943/320*x^13 + 48301/6400*x^12 + 328079/64000*x^11 + 745869/256000*x^10 + 27691787/20480000*x^9 + 41887701/81920000*x^8 + 60286491/409600000*x^7 +
    41159017/1638400000*x^6 - 2535961/13107200000*x^5 - 602647659/262144000000*x^4 - 2137207039/2621440000000*x^3 - 1355028301/10485760000000*x^2 - 16350628239/1677721600000000*x -
    1908029761/6710886400000000;
phi1 := -x^17 - 15/4*x^16 - 69/10*x^15 - 359/40*x^14 - 2943/320*x^13 - 48301/6400*x^12 - 328079/64000*x^11 - 745869/256000*x^10 - 27691787/20480000*x^9 - 41887701/81920000*x^8 - 60286491/409600000*x^7 -
    41159017/1638400000*x^6 + 2535961/13107200000*x^5 + 602647659/262144000000*x^4 + 2137207039/2621440000000*x^3 + 3473708888099/35389440000000000*x^2 + 16350628239/1677721600000000*x -
    8557589302083/838860800000000000;

KX<t> := FunctionField(X);
phi := (-8192/263671875*t^2 - 512/48828125)/(t^17 + 15/4*t^16 + 69/10*t^15 + 359/40*t^14 + 2943/320*t^13 + 48301/6400*t^12 + 328079/64000*t^11 + 745869/256000*t^10 + 27691787/20480000*t^9 + 41887701/81920000*t^8 + 60286491/409600000*t^7 + 41159017/1638400000*t^6 - 2535961/13107200000*t^5 - 602647659/262144000000*t^4 - 2137207039/2621440000000*t^3 - 1355028301/10485760000000*t^2 - 16350628239/1677721600000000*t - 1908029761/6710886400000000);

// plane model
R<t,x> := PolynomialRing(QQ,2);
F := t*x^17 + 15/4*t*x^16 + 69/10*t*x^15 + 359/40*t*x^14 + 2943/320*t*x^13 + 48301/6400*t*x^12 + 328079/64000*t*x^11 + 745869/256000*t*x^10 + 27691787/20480000*t*x^9 + 41887701/81920000*t*x^8 + 60286491/409600000*t*x^7 + 41159017/1638400000*t*x^6 - 2535961/13107200000*t*x^5 - 602647659/262144000000*t*x^4 - 2137207039/2621440000000*t*x^3 - 1355028301/10485760000000*t*x^2 - 16350628239/1677721600000000*t*x - 1908029761/6710886400000000*t + 8192/263671875*x^2 + 512/48828125;
S<s> := PolynomialRing(L);

Mabs_poly := 92850854254985871360000000000000000000000*x^34 + 696381406912394035200000000000000000000000*x^33 + 2587056926679543840768000000000000000000000*x^32 + 6471704541572515233792000000000000000000000*x^31 + 12378527698571260172697600000000000000000000*x^30 + 19306071902751846668697600000000000000000000*x^29 + 25471097326693132240158720000000000000000000*x^28 + 29109373904588085028454400000000000000000000*x^27 + 29280485506809152296452096000000000000000000*x^26 + 26202956578041845231124480000000000000000000*x^25 + 21015434946058173066667622400000000000000000*x^24 + 15176296065212226054232473600000000000000000*x^23 + 9890837020253987285489418240000000000000000*x^22 + 5818786229747758480270295040000000000000000*x^21 + 3083218926727291208535638016000000000000000*x^20 + 1463653966386053452738565505024000000000000*x^19 + 616431640494601682199552983040000000000000*x^18 + 226211988052746988033955541811200000000000*x^17 + 69800774132966169092676806246400000000000*x^16 + 16612947306289105908032329482240000000000*x^15 + 2132342650007873695774062673920000000000*x^14 - 485487650420915568169552183296000000000*x^13 - 448113030876264955926309765120000000000*x^12 - 178479453369644683171894709452800000000*x^11 - 47554468053002752732239627878400000000*x^10 - 8119721651748147416626859704320000000*x^9 - 333672665226972633764183347200000000*x^8 + 310107162663830942831062573056000000*x^7 + 117237692857720594021317425664000000*x^6 + 23545931103618384285367924377600000*x^5 + 2952789282862248020815356568422400*x^4 + 215617407640121680950825319680000*x^3 + 6280175822411050450211737815120*x^2 - 193150745953460091832825449000*x + 960209120865919874927995989;
> Mabs := $1;
> GaloisGroup(Mabs);

// quartic polynomial

L<nu> := QuadraticField(5);
R<t,x> := PolynomialRing(L,2);
// f is the polynomial defining the quadratic extension of QQ(sqrt(5))
f := x^4 + (-7920*t^18 + 153600*t^17)*x^3 + (23522400*t^36 - 681984000*t^35 + 1880064000*t^34)*x^2 + (-31049568000*t^54 + 894136320000*t^53 + 8657141760000*t^52 - 265597747200000*t^51)*x + 15369536160000*t^72 - 289043251200000*t^71 - 11665376870400000*t^70 + 196761747456000000*t^69 + 734175166464000000*t^68;

disc := (36864000*nu - 460800000)*s^35 + (-995328000*nu + 12441600000)*s^34

f1_poly := x^2 + (-3960*t^18 + (-17280*nu + 76800)*t^17)*x + 3920400*t^36 + (24998400*nu - 36864000)*t^35 + (-414720000*nu - 1262592000)*t^34;

// TODO:
/*
 * Loop over small t0 := a + b*sqrt(5)
 * Plug in to Belyi map
 * Take absolute field to get field ext of QQ
 * Polredbest
 * Compute Galois group: if it's 34T88 (order 133171200), that's bad; otherwise return t0 and group. Hopefully it's C2 x 17T7

*/


// copypasta
/*
  R<t,x> := PolynomialRing(QQ,2);
  // this is Sam's version of Belyi map
  F := t*x^17 + 15/4*t*x^16 + 69/10*t*x^15 + 359/40*t*x^14 + 2943/320*t*x^13 + 48301/6400*t*x^12 + 328079/64000*t*x^11 + 745869/256000*t*x^10 + 27691787/20480000*t*x^9 + 41887701/81920000*t*x^8 + 60286491/409600000*t*x^7 + 41159017/1638400000*t*x^6 - 2535961/13107200000*t*x^5 - 602647659/262144000000*t*x^4 - 2137207039/2621440000000*t*x^3 - 1355028301/10485760000000*t*x^2 - 16350628239/1677721600000000*t*x - 1908029761/6710886400000000*t + 8192/263671875*x^2 + 512/48828125;
  // this is Raymond's version, but it's just -1 times mine
  F2 := -t*x^17 - 15/4*t*x^16 - 69/10*t*x^15 - 359/40*t*x^14 - 2943/320*t*x^13 - 48301/6400*t*x^12 - 328079/64000*t*x^11 - 745869/256000*t*x^10 - 27691787/20480000*t*x^9 - 41887701/81920000*t*x^8 - 60286491/409600000*t*x^7 - 41159017/1638400000*t*x^6 + 2535961/13107200000*t*x^5 + 602647659/262144000000*t*x^4 + 2137207039/2621440000000*t*x^3 + (1355028301/10485760000000*t - 8192/263671875)*x^2 + 16350628239/1677721600000000*t*x + 1908029761/6710886400000000*t - 512/48828125

  F;
  C := Curve(AffineSpace(R), F);
  Genus(C);
  g := elt< Integers(QuadraticField(5)) | 1, -2 >;
  g;
  t0 := 27+g;
  Evaluate(F,[t0,x]);
  R<t,x> := PolynomialRing(Parent(t0), 2);
  F := R!F;
  Parent(t0);
  L;
  L<nu> := QuadraticField(5);
  R<t,x> := PolynomialRing(L, 2);
  F := R!F;
  Evaluate(F,[t0,x]);
  Fev := $1;
  Factorization(Fev);
  GaloisGroup(Fev);
  S<s> := PolynomialRing(L);
  Evaluate(Fev,s);
  Evaluate(Fev,[s,s]);
  Fev := $1;
  GaloisGroup(Fev);
  M<b> := ext< L | Fev>;
  M;
  AbsoluteField(M);
  Mabs := $1;
  GaloisGroup(Mabs);
*/

// copypasta 2, electric boogaloo
/*
  QQ := Rationals();
  L<nu> := QuadraticField(5);
  Lt<t> := FunctionField(L);

  R<x> := PolynomialRing(Lt);
  f := x^4 + (-7920*t^18 + 153600*t^17)*x^3 + (23522400*t^36 - 68
  1984000*t^35 + 1880064000*t^34)*x^2 + (-31049568000*t^54 + 8941
  36320000*t^53 + 8657141760000*t^52 - 265597747200000*t^51)*x + 
  15369536160000*t^72 - 289043251200000*t^71 - 11665376870400000*
  t^70 + 196761747456000000*t^69 + 734175166464000000*t^68;
  Factorization(f);
  facts := $1;
  fact[1][1];
  facts[1][1];
  f1 := $1;
  Discriminant(f1);
  Factorization((36864000*nu - 460800000));
  Factorization((36864000*nu - 460800000);
  Factorization(36864000*nu - 460800000);
  OL := Integers(L);
  Factorization((36864000*nu - 460800000)*OL);
  lc_facts := $1;
  lc_facts[2];
  P := $1[1];
  IsPrincipal(P);
  _, g := IsPrincipal(P);
  g;
  Factorization(Discriminant(f1));
  Discriminant(f1);
  S<s> := PolynomialRing(L);
  Discriminant(f1);
  Evaluate($1,s);
  Lt!Discriminant(f1);
  Evaluate($1,s);
  disc := (36864000*nu - 460800000)*s^35 + (-995328000*nu + 12441
  600000)*s^34;

  disc;
  Factorization(disc);
  g;
  printf "%m\n", g;
  R;
  S<x> := PolynomialRing(QQ);
  Mabs_poly := 92850854254985871360000000000000000000000*x^34 + 6
  96381406912394035200000000000000000000000*x^33 + 25870569266795
  43840768000000000000000000000*x^32 + 64717045415725152337920000
  00000000000000000*x^31 + 12378527698571260172697600000000000000
  000000*x^30 + 19306071902751846668697600000000000000000000*x^29
   + 25471097326693132240158720000000000000000000*x^28 + 29109373
  904588085028454400000000000000000000*x^27 + 2928048550680915229
  6452096000000000000000000*x^26 + 262029565780418452311244800000
  00000000000000*x^25 + 21015434946058173066667622400000000000000
  000*x^24 + 15176296065212226054232473600000000000000000*x^23 + 
  9890837020253987285489418240000000000000000*x^22 + 581878622974
  7758480270295040000000000000000*x^21 + 308321892672729120853563
  8016000000000000000*x^20 + 146365396638605345273856550502400000
  0000000*x^19 + 616431640494601682199552983040000000000000*x^18 
  + 226211988052746988033955541811200000000000*x^17 + 69800774132
  966169092676806246400000000000*x^16 + 1661294730628910590803232
  9482240000000000*x^15 + 213234265000787369577406267392000000000
  0*x^14 - 485487650420915568169552183296000000000*x^13 - 4481130
  30876264955926309765120000000000*x^12 - 17847945336964468317189
  4709452800000000*x^11 - 47554468053002752732239627878400000000*
  x^10 - 8119721651748147416626859704320000000*x^9 - 333672665226
  972633764183347200000000*x^8 + 31010716266383094283106257305600
  0000*x^7 + 117237692857720594021317425664000000*x^6 + 235459311
  03618384285367924377600000*x^5 + 295278928286224802081535656842
  2400*x^4 + 215617407640121680950825319680000*x^3 + 628017582241
  1050450211737815120*x^2 - 193150745953460091832825449000*x + 96
  0209120865919874927995989;

  AttachSpec("~/github/Belyi/Code/spec");
  Polredbest(Mabs_poly);
  Polredbest(Mabs_poly);
  Polredbest(Mabs_poly);
  Polredbest(Mabs_poly);
  Polredbest(Mabs_poly);
  Mabs_best := $1;
  GaloisGroup(Mabs_best);
  Mabs_gp := $1;
  Mabs_gp;
  TransitiveGroupDescription($1);
  TransitiveGroupIdentification($1);

  f;
  Discriminant(f);
  f1;
  Discriminant(f1);
  f;
  Parent(f);
  g;
  CoefficientsAndMonomials(f);
  Eltseq(f);
  Terms(f);
  ; 
  L;
  R<x,t> := PolynomialRing(L,2);
  f := x^4 + (-7920*t^18 + 153600*t^17)*x^3 + (23522400*t^36 - 68
  1984000*t^35 + 1880064000*t^34)*x^2 + (-31049568000*t^54 + 8941
  36320000*t^53 + 8657141760000*t^52 - 265597747200000*t^51)*x + 
  15369536160000*t^72 - 289043251200000*t^71 - 11665376870400000*
  t^70 + 196761747456000000*t^69 + 734175166464000000*t^68;
  t0;
  g;
  Evaluate(f,[x,g+27]);
  IsUnivariate($1);
  _, fs := $1;
  fs;
  Factorization(fs);
  Discriminant(f1);
  disc;
  Factorization(disc);
  Evaluate(disc, g+27);
  h := $1;
  Factorization(h*OL);
  IsSquare(h*OL);
  _, sqrt_h := $1;

  sqrt_h;
  IsPrinicpal($1);
  IsPrincipal($1);
  f1;
  Parent(f1);
  R;
  R!f1;
  f1_poly := x^2 + (-3960*t^18 + (-17280*nu + 76800)*t^17)*x + 39
  20400*t^36 + (24998400*nu - 36864000)*t^35 + (-414720000*nu - 1
  262592000)*t^34;
  Parent(f1_poly);
  Factorization(f1_poly);
  Evaluate(f1_poly, [x,27+g]);
  IsUnivariate($1);
  _, f1_poly_1 := $1;
  Factorization(f1_poly_1);
  Evaluate(f1_poly, [27+g,x]);
  IsUnivariate($1);
  _, f1_poly_1 := $1;
  Factorization(f1_poly_1);
  R<t,x> := PolynomialRing(L,2);
  f := x^4 + (-7920*t^18 + 153600*t^17)*x^3 + (23522400*t^36 - 68
  1984000*t^35 + 1880064000*t^34)*x^2 + (-31049568000*t^54 + 8941
  36320000*t^53 + 8657141760000*t^52 - 265597747200000*t^51)*x + 
  15369536160000*t^72 - 289043251200000*t^71 - 11665376870400000*
  t^70 + 196761747456000000*t^69 + 734175166464000000*t^68;
  f1;
  Parent(f1);
  f1_poly := x^2 + (-3960*t^18 + (-17280*nu + 76800)*t^17)*x + 39
  20400*t^36 + (24998400*nu - 36864000)*t^35 + (-414720000*nu - 1
  262592000)*t^34;
  f1_poly;

  Evaluate(f1_poly, [27+g, x]);
  IsUnivariate($1);
  _, f1_poly_1 := $1;
  Factorization(f1_poly_1);
  Discriminant(f1);
  f1;
  Discriminant(f1_poly);
  Discriminant(f1_poly_1);
  f1_poly;
  Resultant(f, Derivative(f,x));
  Resultant(f, Derivative(f,x),x);
  Discriminant(f1);
  f1;
  disc;
  Evaluate(disc, 27+g);
  IsSquare($1);
  Evaluate(disc, 27+g)*OL;
  IsSquare($1);
  nu;
  for a, b in [-10..10] do
  disc_ev := Evaluate(disc, a+ b*nu);
  IsSquare(disc_ev);
  end for;
  for a, b in [-10..10] do
  disc_ev := Evaluate(disc, a+ b*nu);
  if IsSquare(disc_ev) then
  print a,b;
  end if;
  end for;
  disc;
  t0 := 2+10*nu;
  f1;
  f1_poly;
  Evaluate(f1_poly, [t0, x]);
  Factorization($1);
  F;
  R;
    F := t*x^17 + 15/4*t*x^16 + 69/10*t*x^15 + 359/40*t*x^14 + 2943/320*t*x^13 + 48301/6400*t*x^12 + 328079/64000*t*x^11 + 745869/256000*t*x^10 + 27691787/20480000*t*x^9 + 41887701/81920000*t*x^8 + 60286491/409600000*t*x^7 + 41159017/1638400000*t*x^6 - 2535961/13107200000*t*x^5 - 602647659/262144000000*t*x^4 - 2137207039/2621440000000*t*x^3 - 1355028301/10485760000000*t*x^2 - 16350628239/1677721600000000*t*x - 1908029761/6710886400000000*t + 8192/263671875*x^2 + 512/48828125;
  t0;
  Evaluate(F, [t0, x]);
  Fev := $1;
  GaloisGroup($1);
  IsUnivariate(Fev);
  _, Fev1 := $1;
  GaloisGroup(Fev1);
  M := ext< L | Fev1>;
  AbsoluteField(M);
  Mabs := $1;
  Polredbest(Mabs);
  Mabs_poly := Polredbest(Mabs_poly);
  Mabs_poly;
  GaloisGroup($1);
*/
