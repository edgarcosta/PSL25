AttachSpec("spec");
SetVerbose("Shimura",true);
sigma := [ PermutationGroup<17 |  
\[ 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1 ],
  \[ 2, 1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17 ]:
   Order := 355687428096000 > |
   [ 3, 12, 15, 11, 14, 6, 7, 17, 2, 5, 13, 10, 16, 1, 4, 8, 9 ],
   [ 11, 9, 3, 4, 5, 8, 10, 6, 2, 7, 1, 14, 17, 12, 15, 16, 13 ],
   [ 12, 2, 11, 15, 7, 8, 10, 16, 13, 14, 4, 9, 1, 5, 3, 17, 6 ]
   ];
Gamma := TriangleSubgroup(sigma);
BelyiMap(Gamma : prec := 80);


// first try
//SetVerbose("Shimura",true);
//sigma := [ PermutationGroup<17 |  
//   \[ 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1 ],
//   \[ 2, 1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17 ]:
//    Order := 355687428096000 > |
//    [ 14, 9, 12, 13, 6, 7, 2, 8, 11, 1, 5, 15, 17, 10, 4, 16, 3 ],
//    [ 2, 1, 3, 9, 7, 8, 5, 6, 4, 14, 13, 15, 11, 10, 12, 17, 16 ],
//    [ 14, 5, 16, 12, 13, 7, 8, 6, 1, 10, 4, 3, 9, 2, 15, 17, 11 ]
//    ];
//Gamma := TriangleSubgroup(sigma);
////BelyiMap(Gamma : prec := 80);
////Runtime error in 'TrianglePhiGenusZeroEquations': Need cycle containing 1 in sigma_0 to have length >= 2 and < a, for convenience >:(
//
//K<nu> := ext<K|Polynomial(K, [2, 2, 2, 4, 1, 1])> where K is RationalField();
//X := Curve(ProjectiveSpace(K,1));
//KX<x> := FunctionField(X);
//
//phi_num := 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(117729072203803265362550084611036902380126476436627991007326347237854730473593376685111846279562*nu^4 - 1960241558143518607151638889266869832341000712519916131734939855261589142572070144529440343201044*nu^3 - 1470562040772140896554166308099553441951520832227897669765164922041769682405405589743694637913756*nu^2 - 513780056272395716519467592067591831936325347212466414705495009397104177858388370602091910143256*nu - 1793710247999191541994359220134041873086642672826049900461359197228836469292956021154168061267364)*x^17 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-1375858644026768547985058960806943367559530946454676483002845556950169617060843253484637612475864*nu^4 - 51968852223862956847038176651357300418552867412143468360523284339974638128594306249781859061941328*nu^3 - 41722423464352900859272715574140860900947723438631457635127386014543533264720995092054452352029296*nu^2 - 15162825276632885695984075527560069941875628254828774317215231595291495882227317006303357906322528*nu - 51572580963773717068883894732556093683804816410522711187591100750487571920963931685359080444184208)*x^16 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-80148414800552379806913525680026224677908378694188144131828969338739886772957688832680404021884688*nu^4 - 630652993029781543461455934568801698858037439397570238865762289005618380424612733495236929296777696*nu^3 - 590183038988148991285473123943061369800774411692010358638372831876675721540198643945099924948702880*nu^2 - 187462600565439400648018007687299952127042881135328089457778455969452956496350308561699067028433472*nu - 651254454357075910031352376005968366502273636388350347288903050192879373489315469523158785833787232)*x^15 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-998911100046699866655393241241383598385988825441476953981936462446514078655029625463104160959910224*nu^4 - 4553931484762533476199644271539728195856074441429877610814763503421953389393873114073259694207962464*nu^3 - 4966888082647561294790739556825841259233442467087506622632149002884701952404215746360101045164375328*nu^2 - 1306386883541460773756918438223548432549336917321217231807775854790562190092983046547169982914923328*nu - 5076520357427844571180105467739505007211293619726043890891993673358311954823103466369597774342947040)*x^14 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-6978885914760471059123619796316211412049527263394178034318592861171810164347991515828969319964976324*nu^4 - 21988752133949669912864749255139587547588350040756629539330310368709434415305507471568991860390134392*nu^3 - 28589014383875109138975448150549918974425754542854136826019127238997634637638853466181767541337650088*nu^2 - 5652872264426607113018129898267044085311191263352019527606035610051679637712603738170713395251111568*nu - 27126069724358312871615032729256638417762826892610122757612182612244958928457055744734115604730398168)*x^13 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-32135337472332590134735956339815000932308154124695332468559932019281064229891305259971339710028085984*nu^4 - 74739972179619044980848268554138893581402111697216317619931425822775063199309776847312027773291407936*nu^3 - 119041125184821088445416254957344841479001900440913631285796745204823622678165723843119251112891493568*nu^2 - 14975397436041224441333612730759361496315386397137367254490345815548857435156679587349259554398416768*nu - 105614755700754561760372920040017642251804984524804004356232733140373836757863452577743751162200483648)*x^12 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-104953842255733217448962513059929718181667069159811800922219608736259169409961034853377929827031888088*nu^4 - 182734357251754255655416465324748032209247428363259461860856127344659704286911259425927902577278330448*nu^3 - 371118104656330636811763767056300933025856629636287027662369555993556986854406733032531002744311464048*nu^2 - 18395995866489534191529651337745478283996672274471963614715443057365509548083414374261961151484719200*nu - 309491940074725189069208643037740810562985981606471790163005900494752627964355002813627709342196609168)*x^11 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-251871750831988004581327426902772765331840010669848184820654663501865374028080962826399129339562749744*nu^4 - 319715479888573365124941288004089781635317024880885858107239568088542452489826024160244001718094115232*nu^3 - 881460881119534466930307356457104750960154569627402227523332994519742645114688095421669203503290746848*nu^2 + 25692314937086191133006933772818002617406092661630900020691575251228003527693382804452746400291690816*nu - 694292606041469741142790062208264209105112278924601421199332731699660103831009619169711467983471471136)*x^10 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-451347493483856989020747361996877838949914767575080668768517772996304792246398058039307823300451802646*nu^4 - 382791108668796968282774345628460031146746358452767826864437423688274868323878179310948392273885513172*nu^3 - 1604690356845582411003299733789606874344483362872750668383923242331304396103923911184915876180948886236*nu^2 + 174877394889810727333360611808929928578396123738933543520780453131323936002534522532157592370466265192*nu - 1198678201554606974831206138285161656259421878282121638160218033437151277460043808811505916695130099044)*x^9 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-605356139331845895707282840673187478960240530200609434949558854612233083138557995775456019987493015176*nu^4 - 266127481981106208653310025327255231838581046872030592337090513506193143603537229401324340441675266800*nu^3 - 2229651762204603557226364331742404781681404475293738822977158237660217001454318731622936440578423855440*nu^2 + 421308700600079733215393083255462269548927871924995228808566318797641647235651274782663023468373589728*nu - 1584553026252502531223239350429171740509575992496702873214846274654524180213282244659922462651629058480)*x^8 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-601461763127333644409358236122170583153825551922368864619388887352171321421159391606858066563963353000*nu^4 - 10074210214391079931074678245909779814470032496753649930755476486312604247057056220246659844239657136*nu^3 - 2328270116949606681437418924026973672223515912909572037688666829574294543584254116346200258688926471312*nu^2 + 625003704442973673428949790581701963303491899841331927121898596876705697108972652668171021736664358496*nu - 1577405443831104482249603812471862717467683780062360036093038340299608896296408062579518543138245470832)*x^7 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-431441217762236905256911595522075432859944734111798623917105296355736612904778434579396659168405877952*nu^4 + 190660130340719866614816455637012044403691824273573979418564505449635434539271870529138456484529154432*nu^3 - 1771984793446740286322763378116025130927471975355531394633334247190712150785814588752659352044112465792*nu^2 + 614919735062541002914758288689208297605722001949125042840655113859777430253173975145730050735756969216*nu - 1145131336122901597377619040880168394637096289983587496669434097178411538271069069925147264472072091776)*x^6 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-212422547160803813143035285280131652309074142081606902173054335761998217708945617901683496967979752608*nu^4 + 202128107832848137409077310804447163661497263452430225281208468577088027554997204044074660455121475904*nu^3 - 929188117835141379654797977083780057801524433422544045228835500895703064317507702228476374099580173888*nu^2 + 394329643149306979335999999477736213143942363349552938824645876594930104710672869947715026010244071808*nu - 572081952257582657535383824545192865774855669281822589276644149103538483976716087866565287222454255040)*x^5 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-64732270785636438624899644452720848218208696252555574337059351238296823102206763820866564802238247040*nu^4 + 98093861827465245459000874306215070389216373687030720974371306483376884915667584246326519073006379264*nu^3 - 300519595885290315882878099587798030615039479937874712821824193981817597804886481469388381510040872192*nu^2 + 150280755029453167964146139672612300396034214970435905558037531618026680136579580240837713222872518144*nu - 175699193573529336362600618669291020762969035599853638435786260483451861499161967333473482525661940480)*x^4 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-9301977312148835615576681512287874263839828139790224496356995910528038543676913749579369757276525952*nu^4 + 19662455242019582743165732505493566274691784558183550762813329835056909168033911775782434728576822016*nu^3 - 45239839337999239612311341509097816326736592506989038093515989329730113377784841599925619004174817024*nu^2 + 25933622274687192187648330390388088678937314811281652433637061387844068875000487376587674975032629760*nu - 24978880399956423623920091268605411798561434714378258641450657765294547658022441070537080951388584192)*x^3;
//phi_den := x^17 + 1/24519896962219995014570271433*(92700290654773097240588474329*nu^4 + 28918199698141298455696478792*nu^3 + 319418781230298277771064848834*nu^2 - 54596664550052045809989548260*nu + 64991598168894964297174289428)*x^16 + 1/493427863311827589045507652751664578707395241*(-4525435195161292428528581516189652618200326820*nu^4 - 6104955568946190234661107806407463558615647480*nu^3 - 7640999916646047731057847473948874904427269928*nu^2 - 4200463929469805452711623508606376709292746640*nu + 3244933110131212563231907173392556195017677960)*x^15 + 1/9929530155351521649692323834071887200639755983300622092510857*(-1056829758398097198209882635830396334602865997548759430429797308*nu^4 + 50268328158425171003187457088325341043183906472686981403920440*nu^3 - 4065493398202226581101470950898701921377196189265831667148902360*nu^2 + 1179357442330109411171032074740712073226081535760873655579322768*nu - 3064358897815868380019181488687080633050818753919742184111344488)*x^14 + 1/1880972553305833072643334668406673016678801293603324474192194878636258719*(-1097649876259042836116865551591423638995597180997250646568725279315922066554*nu^4 + 79003137575453682548923598570010895006963760582380659542474607866558544884*nu^3 - 4834265299492882803729616804775351032682387988669006084276286054844263218628*nu^2 + 1436766164378443812739731306273087869204873105255458646186734145698133380440*nu - 3237243929621909978653574225821135494938100349681154280911090739987961212860)*x^13 + 1/356316733111790624713665829951957820445894495962498661307995981388754363825439601273*(25975685811149193520355054365793517306230327005178659053689736488308711911438599105502*nu^4 - 95526748188914593306694273492906784305578932898987050054243312399281525865288646457404*nu^3 - 59155242473329311561948930974710093402511252084019837231959689113390809534709407215444*nu^2 - 14743938750292672675712797784022408915623862742093337877799911583010687885185454592072*nu - 106997398052029707648102046641033771427893647004514374027902226136812453379771714484972)*x^12 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(970497163157121970649555000913535314795393413437694345160338929818023943405405446628650304897392388*nu^4 + 31648552577270010625858756985095679380170425930914043940534164243080665896336091220207579722613240*nu^3 + 3975474393055795998800403725183550358991291424821917470559188421423663838539606768893075216887793192*nu^2 - 1093277916553508264762979961992083206438627703124838324274995856592103381968977758873621817281642608*nu + 2728286223839921725980000548437356497232453371462826069449903393615267206937680939507002855046908248)*x^11 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(4756112951696179938014220644877720866098538500676657438310436711167154678678225995378718968535001276*nu^4 + 1130460243593196361695902868767191442721915814754857068814890762401396468090597085088144387190992520*nu^3 + 18764143416805836151618857864887901147835206309075116424894106001190406052952191890824682993370225496*nu^2 - 4441166400460645272093446647836689676059030273584148114858429341761389219679792006718815779907129488*nu + 13120167746260363432262997017607230648475684234487120735685788409815063524203664918257607549394849576)*x^10 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(6623988418747994927396307511172970352630559960376515024605755550998060234863840145899473845893270453*nu^4 + 3393435812792294784299847565785185676715601195203492571038558917577509744429021488818173823332022166*nu^3 + 23935272831074775864049669229443592365506643097753782273343531447239313301606314872882211166142351890*nu^2 - 4112886398743720282547380105118131014880807162253930946925374457235963515147630958310523669823897804*nu + 17133132612612763403083878586022092285397265955848761157719356364819837188943059934146775952767434702)*x^9 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-30729083326922408829257015750642749047859397668549056952059732945262167890722406041742964463371685737*nu^4 - 4746443717181960175508118016391613958177325351520009381719919081897077256621813806258613759424919598*nu^3 - 122715634618605825867514315650154478886546884491204017389701469577437129865053283722980661256490640154*nu^2 + 30919684192904437185729829528802695170673617025418434838280145005421470902582362099096803547522645116*nu - 85082880372873506176282225447509889864453112970538238645631819003940814181898702354283240906888750150)*x^8 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-194633260581174368528069090716212489703143859566808098991948091620843279917211580732728944071584111952*nu^4 - 53687905034658596004750282445051284020653531925023166867967365832807239266573164128937040991784367456*nu^3 - 743335774547663618063436872700601602957845960999575025933241174203501602100717449536535348093188224288*nu^2 + 166609139433196620870706235308396586474360409206878051733033599750226349263105995144961201266042619072*nu - 519751142979471379382904972306078337621088288964307661504083339710889970076305289045081972729811445984)*x^7 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-550605055221399724589456492511962978822214203997819992316234743955534113776004731199304458139423050000*nu^4 - 157388846387615144762422145818317885652279915776873757630707944392442608561258267046163822463768419808*nu^3 - 2080988766560051495996528246781498494297160421966188485646888690214509972657803277353470173082926049952*nu^2 + 458522152155006992962557711159773554846667083232560813740556827908418776123203182380138423199585947072*nu - 1454645875056811875481419272976289045396197677946578088062580213121884600591947378343807551440677632864)*x^6 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-987770856934470382937960846233364669535413501030340158020364589619917274488338889094491448433092332960*nu^4 - 257481151414599009566523338838470824979832495977610265319701657050122520394906054404828504092209956032*nu^3 - 3739045340466901673863700521611090613430112316225536610315516506888228621027585104919583630336245180480*nu^2 + 840510604194166459858031328810738126458157094309027978535037530619095945353294230360486385155098385792*nu - 2605675774358044028012658325443039654956763535914343632463867752748969875184755447656203621369434420160)*x^5 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-1209608677891422928667472494153452709753697386357467837701793736455490231269290615619474791555764473312*nu^4 - 260644532604282634114251919587323996079709065722874735406501437055366553537233773681796651803323040832*nu^3 - 4616119708545922635516614454270196327930046286639192175515382830795371998093496138417844977335138970304*nu^2 + 1079245208198462530859108027681033383404692845802085180585496934491593478243533381327652423041050338432*nu - 3202044140097392763234555841397162140742163236628483989528291224959688079885662307895190272834815478080)*x^4 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-1019178998241819570391579264178828632771112933416292653770935109197604092933037196856055072858380842240*nu^4 - 161919358970504702279347948802804169269768048029328488001531562429166338448205674327459345243908249088*nu^3 - 3932834280975831606214918117584023479350348563209461621672043636091586502535600105199746553103680213504*nu^2 + 963802865272424470108087643284639461757482405882175410041260987917170229864703753739176915396815932416*nu - 2712975184814225491507529821498483706915889052349445140984918854925309420362570815451921293431350939136)*x^3 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-570453324550640611890194878055311317483467707812872093875628143450812755590606313629944095181359157504*nu^4 - 55867418473824855369314727759164034040816024040484121413112042738326027126880412311244948817986117120*nu^3 - 2226237861994575417530099381140290863051472312254105170391062976625917828504801743880523494467473615360*nu^2 + 571754594495824232274961511332318259637496856336821403143421022762426039280234816412860128733268204544*nu - 1526582725685575087715431400339856462749456744504744749508848611598583581259728477484065701332345992704)*x^2 + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-192317207904790725320502039428097029809106550543737261143995965594453754778852729626328447465004065536*nu^4 - 7505113416946142624896000736021002535434253237681741691542426000965845516491712811632482340263246336*nu^3 - 757581947061159477110604576519311707888564491779326259527765775219584823404596997909509838199379582464*nu^2 + 202816137977073877264717956144382169768530627736019042833876036916299739403225029118911202600812794880*nu - 516417610163925998646723866300300423757880852673114123877538370524929241927736231432655200339352633856)*x + 1/67497855868402962662173128057423522758657578791357297254391535670543280626891632946675259570991*(-29703816170733498230317773240919871169964748849401736947804244963196721005235309080793056277232009472*nu^4 + 370561491025533089909942225237215741622131440442815530383992499539823664858917283526569038634320384*nu^3 - 117727384533581871080716972042919272197489595759287225738717541850736111503116981542694503561562982912*nu^2 + 32583043886159940825941412703014181747363836550212881309922437983287736718643067858089612139178892288*nu - 79810569380823042270083748448977421089101535041109929493846801565801121159488885345666368395909387776);
//phi := phi_num/phi_den;
